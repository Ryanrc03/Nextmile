â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  Nextmile é¡¹ç›®è¿ç§» - å¿«é€Ÿå‚è€ƒå¡                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ ä¸€. æœ€å¿«éƒ¨ç½²æ–¹å¼ï¼ˆæ¨èï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨æ–°æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š
  $ git clone https://github.com/Ryanrc03/Nextmile.git
  $ cd Nextmile
  $ ./scripts/deploy_to_new_server.sh --domain ä½ çš„åŸŸå.com --email ä½ çš„é‚®ç®±@example.com

å®Œæˆï¼ğŸ‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ äºŒ. å®Œæ•´è¿ç§»æµç¨‹ï¼ˆ3æ­¥ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£  åœ¨æ—§æœåŠ¡å™¨å¤‡ä»½
   $ ssh æ—§æœåŠ¡å™¨
   $ cd Nextmile
   $ ./scripts/backup_before_migration.sh
   $ exit
   ä¸‹è½½å¤‡ä»½: scp -i key.pem ec2-user@æ—§æœåŠ¡å™¨:~/migration_backup_*.tar.gz .

2ï¸âƒ£  åœ¨æ–°æœåŠ¡å™¨éƒ¨ç½²
   $ ssh æ–°æœåŠ¡å™¨
   $ git clone https://github.com/Ryanrc03/Nextmile.git
   $ cd Nextmile
   $ ./scripts/deploy_to_new_server.sh --domain åŸŸå.com --email é‚®ç®±@example.com

3ï¸âƒ£  è¿ç§»æ•°æ®
   ä¸Šä¼ å¤‡ä»½: scp -i key.pem migration_backup_*.tar.gz ec2-user@æ–°æœåŠ¡å™¨:~/
   $ ssh æ–°æœåŠ¡å™¨
   $ cd Nextmile
   $ ./scripts/migrate_data.sh --from æ—§æœåŠ¡å™¨IP --ssh-key ~/.ssh/key.pem

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ› ï¸  ä¸‰. å¯ç”¨è„šæœ¬
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è„šæœ¬å                          è¯´æ˜                    è¿è¡Œä½ç½®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
deploy_to_new_server.sh         ğŸš€ ä¸»éƒ¨ç½²è„šæœ¬           æ–°æœåŠ¡å™¨
init_new_server.sh              ğŸ”§ åˆå§‹åŒ–ç¯å¢ƒ           æ–°æœåŠ¡å™¨
backup_before_migration.sh      ğŸ’¾ å¤‡ä»½æ•°æ®             æ—§æœåŠ¡å™¨
migrate_data.sh                 ğŸ“¦ è¿ç§»æ•°æ®             æ–°æœåŠ¡å™¨
check_deployment.sh             âœ… æ£€æŸ¥çŠ¶æ€             æ–°æœåŠ¡å™¨

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸  å››. ä¸»è„šæœ¬å‚æ•°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

deploy_to_new_server.sh å‚æ•°:

  --domain <åŸŸå>           âœ… å¿…éœ€
  --email <é‚®ç®±>            âœ… å¿…éœ€ï¼ˆä¸è·³è¿‡SSLæ—¶ï¼‰
  --db-host <ä¸»æœº>          å¯é€‰ï¼ˆé»˜è®¤: localhostï¼‰
  --db-name <æ•°æ®åº“å>      å¯é€‰ï¼ˆé»˜è®¤: nextmile_dbï¼‰
  --db-user <ç”¨æˆ·å>        å¯é€‰ï¼ˆé»˜è®¤: nextmile_userï¼‰
  --db-password <å¯†ç >      å¯é€‰
  --skip-ssl               è·³è¿‡SSLé…ç½®
  --skip-db                è·³è¿‡æ•°æ®åº“å®‰è£…
  --project-dir <è·¯å¾„>      å¯é€‰ï¼ˆé»˜è®¤: /home/ec2-user/Nextmileï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Œ äº”. ä½¿ç”¨ç¤ºä¾‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# æ ‡å‡†éƒ¨ç½²
./scripts/deploy_to_new_server.sh \
  --domain nextmile.space \
  --email admin@nextmile.space

# è·³è¿‡SSLï¼ˆæ‰‹åŠ¨é…ç½®ï¼‰
./scripts/deploy_to_new_server.sh \
  --domain nextmile.space \
  --skip-ssl

# ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆå¦‚ AWS RDSï¼‰
./scripts/deploy_to_new_server.sh \
  --domain nextmile.space \
  --email admin@nextmile.space \
  --db-host mydb.xxxx.rds.amazonaws.com \
  --db-user admin \
  --db-password secret123 \
  --skip-db

# æ•°æ®è¿ç§»
./scripts/migrate_data.sh \
  --from 54.123.45.67 \
  --ssh-key ~/.ssh/my-key.pem

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… å…­. éƒ¨ç½²åæ£€æŸ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# è¿è¡ŒçŠ¶æ€æ£€æŸ¥è„šæœ¬
$ ./scripts/check_deployment.sh

# æ‰‹åŠ¨æ£€æŸ¥
$ pm2 status                              # PM2 è¿›ç¨‹
$ sudo systemctl status nginx             # Nginx çŠ¶æ€
$ curl http://localhost:3000              # å‰ç«¯æµ‹è¯•
$ curl http://localhost:8000/health       # API æµ‹è¯•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ ä¸ƒ. å¸¸ç”¨ç®¡ç†å‘½ä»¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PM2:
  pm2 status              æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
  pm2 logs                æŸ¥çœ‹æ—¥å¿—
  pm2 restart all         é‡å¯æ‰€æœ‰æœåŠ¡
  pm2 monit              å®æ—¶ç›‘æ§

Nginx:
  sudo nginx -t                          æµ‹è¯•é…ç½®
  sudo systemctl restart nginx           é‡å¯æœåŠ¡
  sudo tail -f /var/log/nginx/error.log  æŸ¥çœ‹é”™è¯¯æ—¥å¿—

ç¯å¢ƒå˜é‡:
  nano .env.production    ç¼–è¾‘é…ç½®
  pm2 restart all         é‡å¯ç”Ÿæ•ˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ å…«. DNS é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åœ¨åŸŸåæ³¨å†Œå•†æ·»åŠ  A è®°å½•:
  ä¸»æœºå: @
  ç±»å‹:   A
  å€¼:     æ–°æœåŠ¡å™¨IPåœ°å€
  TTL:    3600

ç­‰å¾… DNS ç”Ÿæ•ˆï¼ˆ5-30åˆ†é’Ÿï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” ä¹. AWS å®‰å…¨ç»„é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å¿…é¡»å¼€æ”¾çš„ç«¯å£:
  HTTP  (80)   - 0.0.0.0/0
  HTTPS (443)  - 0.0.0.0/0
  SSH   (22)   - ä½ çš„IP/32 ï¼ˆæ¨èé™åˆ¶ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“š å. æ–‡æ¡£èµ„æº
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

DEPLOYMENT_SCRIPTS_GUIDE.md    è„šæœ¬è¯¦ç»†ä½¿ç”¨æŒ‡å—
MIGRATION_GUIDE.md              å®Œæ•´è¿ç§»æ•™ç¨‹ï¼ˆæ‰‹åŠ¨æ­¥éª¤ï¼‰
scripts/README.md               è„šæœ¬ç›®å½•è¯´æ˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ› åä¸€. æ•…éšœæ’æŸ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è„šæœ¬å¤±è´¥:
  bash -x ./scripts/deploy_to_new_server.sh ...  # è°ƒè¯•æ¨¡å¼

åº”ç”¨ä¸å¯åŠ¨:
  pm2 logs                                        # æŸ¥çœ‹æ—¥å¿—
  sudo lsof -i :3000                              # æ£€æŸ¥ç«¯å£

SSL é—®é¢˜:
  sudo certbot certificates                       # æŸ¥çœ‹è¯ä¹¦
  sudo certbot --nginx -d åŸŸå.com                # é‡æ–°è·å–

æ•°æ®åº“:
  mysql -u nextmile_user -p nextmile_db           # æµ‹è¯•è¿æ¥
  sudo systemctl status mysqld                    # æ£€æŸ¥æœåŠ¡

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¡ åäºŒ. æœ€ä½³å®è·µ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. éƒ¨ç½²å‰å…ˆå¤‡ä»½æ—§æœåŠ¡å™¨æ•°æ®
2. ç¡®ä¿æ–°æœåŠ¡å™¨è‡³å°‘æœ‰ 2GB RAM
3. å…ˆé…ç½® DNSï¼Œç­‰å¾…ç”Ÿæ•ˆåå†éƒ¨ç½²ï¼ˆé¿å… SSL è·å–å¤±è´¥ï¼‰
4. éƒ¨ç½²åç«‹å³è¿è¡Œ check_deployment.sh éªŒè¯
5. ä¿®æ”¹ .env.production ä¸­çš„æ•æ„Ÿä¿¡æ¯
6. é…ç½®è‡ªåŠ¨å¤‡ä»½ï¼ˆcrontabï¼‰
7. å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œä¾èµ–

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¬ éœ€è¦å¸®åŠ©ï¼Ÿ
   æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£æˆ–æäº¤ GitHub Issue

ğŸ‰ ç¥éƒ¨ç½²é¡ºåˆ©ï¼

â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
